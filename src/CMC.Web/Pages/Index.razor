@page "/"
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Authorization
@attribute [AllowAnonymous]
@inject IJSRuntime JS

<PageTitle>CMC - Home</PageTitle>

<canvas id="canvas" style="
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      display: block;
      z-index: -1;
      pointer-events: auto;
"></canvas>
<section class="slim center">
    <div class="card">
        <h1>
            Welcome to Cybersecurity Management Cockpit
        </h1>
        <NavLink class="btn primary" href="login">
            <span aria-hidden="true"></span> Login
        </NavLink>
    </div>
</section>
<AuthorizeView>
    <Authorized>
        <RedirectToCockpit />
    </Authorized>
    <NotAuthorized>
    </NotAuthorized>
</AuthorizeView>

@code {
    private bool _bgInitDone;

    protected override async Task OnAfterRenderAsync(bool firstRender) // ADD
    {
        if (firstRender && !_bgInitDone)
        {
            try
            {
                // Ruft window.initBgAnimation(document.getElementById('canvas')) auf,
                // ohne ein ElementReference zu ben√∂tigen.
                await JS.InvokeVoidAsync("eval",
                    "window.initBgAnimation && window.initBgAnimation(document.getElementById('canvas'));");
                _bgInitDone = true;
            }
            catch (Exception ex)
            {
            }
        }
    }
}
